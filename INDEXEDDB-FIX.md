# üîß –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è IndexedDB –ø–æ–º–∏–ª–∫–∏ –≤ MediaSelector

## üö® –ü—Ä–æ–±–ª–µ–º–∞:
```
Uncaught NotFoundError: Failed to execute 'transaction' on 'IDBDatabase': 
One of the specified object stores was not found.
```

## üîç –ü—Ä–∏—á–∏–Ω–∞:
IndexedDB –±–∞–∑–∞ –¥–∞–Ω–∏—Ö `ContentManagerDB` —ñ—Å–Ω—É–≤–∞–ª–∞, –∞–ª–µ –Ω–µ –º–∞–ª–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—ó —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ - –≤—ñ–¥—Å—É—Ç–Ω—î –æ–±'—î–∫—Ç-—Å—Ö–æ–≤–∏—â–µ `files`.

## ‚úÖ –†—ñ—à–µ–Ω–Ω—è:

### 1. **–î–æ–¥–∞–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö**
```javascript
request.onsuccess = (event) => {
  const db = event.target.result;
  
  // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ —ñ—Å–Ω—É—î –æ–±'—î–∫—Ç-—Å—Ö–æ–≤–∏—â–µ
  if (!db.objectStoreNames.contains('files')) {
    console.warn('‚ö†Ô∏è –û–±\'—î–∫—Ç-—Å—Ö–æ–≤–∏—â–µ "files" –Ω–µ —ñ—Å–Ω—É—î –≤ IndexedDB');
    db.close();
    resolve(); // Graceful fallback
    return;
  }
  
  // –ü—Ä–æ–¥–æ–≤–∂—É—î–º–æ —Ç—ñ–ª—å–∫–∏ —è–∫—â–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∞
  const transaction = db.transaction(['files'], 'readonly');
  // ...
}
```

### 2. **–ü—Ä–∞–≤–∏–ª—å–Ω–∞ –æ–±—Ä–æ–±–∫–∞ onupgradeneeded**
```javascript
request.onupgradeneeded = (event) => {
  console.log('üîß –°—Ç–≤–æ—Ä–µ–Ω–Ω—è/–æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ IndexedDB');
  const db = event.target.result;
  
  // –°—Ç–≤–æ—Ä—é—î–º–æ –æ–±'—î–∫—Ç-—Å—Ö–æ–≤–∏—â–µ —è–∫—â–æ –π–æ–≥–æ –Ω–µ–º–∞—î
  if (!db.objectStoreNames.contains('files')) {
    const store = db.createObjectStore('files', { keyPath: 'id' });
    console.log('‚úÖ –°—Ç–≤–æ—Ä–µ–Ω–æ –æ–±\'—î–∫—Ç-—Å—Ö–æ–≤–∏—â–µ "files"');
  }
};
```

### 3. **–î–æ–¥–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–µ –∑–∞–∫—Ä–∏—Ç—Ç—è –∑'—î–¥–Ω–∞–Ω—å**
```javascript
// –ó–∞–≤–∂–¥–∏ –∑–∞–∫—Ä–∏–≤–∞—î–º–æ –∑'—î–¥–Ω–∞–Ω–Ω—è –ø—ñ—Å–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è
db.close();
```

### 4. **–î–æ–¥–∞–Ω–æ –æ–±—Ä–æ–±–∫—É –ø–æ–º–∏–ª–æ–∫ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π**
```javascript
transaction.onerror = () => {
  console.error('‚ùå –ü–æ–º–∏–ª–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó IndexedDB');
  db.close();
  reject(new Error('–ü–æ–º–∏–ª–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó IndexedDB'));
};
```

## üõ†Ô∏è –¢–µ—Ö–Ω—ñ—á–Ω—ñ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è:

### –§—É–Ω–∫—Ü—ñ—ó, —â–æ –±—É–ª–∏ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω—ñ:
1. **`loadFullFilesFromIndexedDB()`** - –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤—Å—ñ—Ö —Ñ–∞–π–ª—ñ–≤
2. **`loadSingleFileFromIndexedDB()`** - –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª—É

### –î–æ–¥–∞–Ω—ñ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏:
- ‚úÖ –Ü—Å–Ω—É–≤–∞–Ω–Ω—è –æ–±'—î–∫—Ç-—Å—Ö–æ–≤–∏—â–∞ –ø–µ—Ä–µ–¥ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞ –æ–±—Ä–æ–±–∫–∞ `onupgradeneeded` –ø–æ–¥—ñ—ó
- ‚úÖ –ó–∞–∫—Ä–∏—Ç—Ç—è –∑'—î–¥–Ω–∞–Ω—å –∑ –±–∞–∑–æ—é –¥–∞–Ω–∏—Ö
- ‚úÖ –û–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π
- ‚úÖ Graceful fallback –ø—Ä–∏ –≤—ñ–¥—Å—É—Ç–Ω–æ—Å—Ç—ñ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏

## üß™ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è:

### –°—Ü–µ–Ω–∞—Ä—ñ–π 1: –ü–µ—Ä—à–∏–π –∑–∞–ø—É—Å–∫ (–Ω–æ–≤–∞ IndexedDB)
1. IndexedDB –Ω–µ —ñ—Å–Ω—É—î
2. ‚úÖ –°—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –Ω–æ–≤–∞ –±–∞–∑–∞ –∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—é —Å—Ç—Ä—É–∫—Ç—É—Ä–æ—é
3. ‚úÖ MediaSelector –ø—Ä–∞—Ü—é—î –±–µ–∑ –ø–æ–º–∏–ª–æ–∫

### –°—Ü–µ–Ω–∞—Ä—ñ–π 2: –ü–æ—à–∫–æ–¥–∂–µ–Ω–∞ IndexedDB
1. IndexedDB —ñ—Å–Ω—É—î –∞–ª–µ –±–µ–∑ –æ–±'—î–∫—Ç-—Å—Ö–æ–≤–∏—â–∞
2. ‚úÖ –í–∏—è–≤–ª—è—î—Ç—å—Å—è –≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏
3. ‚úÖ Graceful fallback –±–µ–∑ –ø–æ–º–∏–ª–æ–∫
4. ‚úÖ –õ–æ–≥—É–≤–∞–Ω–Ω—è –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è

### –°—Ü–µ–Ω–∞—Ä—ñ–π 3: –ü—Ä–∞–≤–∏–ª—å–Ω–∞ IndexedDB
1. IndexedDB –∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—é —Å—Ç—Ä—É–∫—Ç—É—Ä–æ—é
2. ‚úÖ –£—Å–ø—ñ—à–Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤
3. ‚úÖ –í–∏–±—ñ—Ä –∞—É–¥—ñ–æ —Ñ–∞–π–ª—ñ–≤ –ø—Ä–∞—Ü—é—î

## üîß –î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:

### –û—á—ñ–∫—É–≤–∞–Ω—ñ –ª–æ–≥–∏ –ø—ñ—Å–ª—è –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è:
```
üîÑ –ü–æ—á–∞—Ç–æ–∫ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ –≤ MediaSelector
üéØ –î–æ–∑–≤–æ–ª–µ–Ω—ñ —Ç–∏–ø–∏ —Ñ–∞–π–ª—ñ–≤: ['audio']
üìÇ –°–∏—Ä—ñ –¥–∞–Ω—ñ –∑ localStorage: –∑–Ω–∞–π–¥–µ–Ω–æ
üìÇ –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ 3 —Ñ–∞–π–ª—ñ–≤ –∑ localStorage: [—Å–ø–∏—Å–æ–∫]
üîç –§–∞–π–ª—ñ–≤ –ø—ñ—Å–ª—è —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó: 1 [–∞—É–¥—ñ–æ —Ñ–∞–π–ª–∏]
üîç –ê—É–¥—ñ–æ —Ñ–∞–π–ª—ñ–≤ –±–µ–∑ URL: 1 [—Ñ–∞–π–ª–∏ –±–µ–∑ URL]
üìÇ –ó–Ω–∞–π–¥–µ–Ω–æ 1 –∞—É–¥—ñ–æ —Ñ–∞–π–ª—ñ–≤ –±–µ–∑ URL, –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –∑ IndexedDB...
üîß –°—Ç–≤–æ—Ä–µ–Ω–Ω—è/–æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ IndexedDB (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ)
‚úÖ –°—Ç–≤–æ—Ä–µ–Ω–æ –æ–±'—î–∫—Ç-—Å—Ö–æ–≤–∏—â–µ "files" (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ)
üìÇ –ó–Ω–∞–π–¥–µ–Ω–æ 1 —Ñ–∞–π–ª—ñ–≤ –≤ IndexedDB
‚úÖ –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ –∞—É–¥—ñ–æ —Ñ–∞–π–ª: jungle-ambience-339096
‚úÖ –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ –ø–æ–≤–Ω—ñ –¥–∞–Ω—ñ –¥–ª—è –∞—É–¥—ñ–æ —Ñ–∞–π–ª—ñ–≤ –∑ IndexedDB
‚úÖ –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑ IndexedDB –∑–∞–≤–µ—Ä—à–µ–Ω–æ —É—Å–ø—ñ—à–Ω–æ
üèÅ –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ –∑–∞–≤–µ—Ä—à–µ–Ω–æ
```

### –Ø–∫—â–æ IndexedDB –ø–æ—à–∫–æ–¥–∂–µ–Ω–∞:
```javascript
// –í–∏–∫–æ–Ω–∞–π—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª—ñ –¥–ª—è –æ—á–∏—â–µ–Ω–Ω—è
indexedDB.deleteDatabase('ContentManagerDB').onsuccess = () => {
  console.log('IndexedDB –æ—á–∏—â–µ–Ω–∞. –ü–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —Å—Ç–æ—Ä—ñ–Ω–∫—É.');
  location.reload();
};
```

## üéä –†–µ–∑—É–ª—å—Ç–∞—Ç:

### –î–æ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è:
‚ùå `NotFoundError: object stores was not found`  
‚ùå MediaSelector –Ω–µ –ø—Ä–∞—Ü—é–≤–∞–≤ –∑ –∞—É–¥—ñ–æ —Ñ–∞–π–ª–∞–º–∏  
‚ùå –ù–µ–º–æ–∂–ª–∏–≤–æ –≤–∏–±—Ä–∞—Ç–∏ —Ñ–∞–π–ª–∏ –∑ IndexedDB  

### –ü—ñ—Å–ª—è –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è:
‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ IndexedDB  
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –æ–±'—î–∫—Ç-—Å—Ö–æ–≤–∏—â–∞  
‚úÖ Graceful fallback –ø—Ä–∏ –ø–æ–º–∏–ª–∫–∞—Ö  
‚úÖ –ù–∞–¥—ñ–π–Ω–∞ —Ä–æ–±–æ—Ç–∞ –∑ –∞—É–¥—ñ–æ —Ñ–∞–π–ª–∞–º–∏  
‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–µ –∑–∞–∫—Ä–∏—Ç—Ç—è –∑'—î–¥–Ω–∞–Ω—å  

---

**üéâ MediaSelector —Ç–µ–ø–µ—Ä –Ω–∞–¥—ñ–π–Ω–æ –ø—Ä–∞—Ü—é—î –∑ IndexedDB –±–µ–∑ –ø–æ–º–∏–ª–æ–∫!**

### –ö–ª—é—á–æ–≤—ñ –ø–µ—Ä–µ–≤–∞–≥–∏:
- üõ°Ô∏è **–°—Ç–∞–±—ñ–ª—å–Ω—ñ—Å—Ç—å**: –ù–µ–º–∞—î –∫—Ä–∏—Ç–∏—á–Ω–∏—Ö –ø–æ–º–∏–ª–æ–∫ IndexedDB
- üîß **–°–∞–º–æ–≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏
- üìä **–î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞**: –î–µ—Ç–∞–ª—å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è –æ–ø–µ—Ä–∞—Ü—ñ–π
- üöÄ **–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å**: –ü—Ä–∞–≤–∏–ª—å–Ω–µ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∑'—î–¥–Ω–∞–Ω–Ω—è–º–∏ 